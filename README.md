# Ассемблер УВМ

Ассемблер для учебной вычислительной машины (УВМ).  
Реализует трансляцию программы на человекочитаемом языке ассемблера
в двоичное машинное представление согласно спецификации УВМ.

Проект реализован поэтапно:
- **Этап 1** — разбор текста и формирование промежуточного представления (IR)
- **Этап 2** — кодирование команд в двоичный формат (10 байт на команду)

---

## Структура проекта
uvm_assembler/

├── assembler.py # CLI-приложение ассемблера

├── parser.py # Разбор языка ассемблера

├── instructions.py # Спецификация команд УВМ

├── ir.py # Промежуточное представление (IR)

├── encoder.py # Кодирование IR в машинный код

├── tests.asm # Тестовая программа из спецификации УВМ

└── README.md

---

## Поддерживаемые команды УВМ

### 1. Загрузка константы
LOAD_CONST B, C
**Семантика:**
memory[B] ← C


---

### 2. Чтение значения из памяти
READ_MEM B, C, D
**Семантика:**
temp = memory[B]
memory[C] ← memory[temp + D]


---

### 3. Запись значения в память
WRITE_MEM B, C
**Семантика:**
memory[memory[C]] ← memory[B]


---

### 4. Побитовый арифметический сдвиг вправо
SHR B, C, D
**Семантика:**
memory[C] ← memory[D] >> memory[B]


---

##  Язык ассемблера

- Одна команда на строку
- Аргументы разделяются запятыми
- Комментарии начинаются с `;`
- Все аргументы — неотрицательные целые числа

### Пример программы

```asm
; Пример программы УВМ

LOAD_CONST 729, 628
READ_MEM   1013, 981, 97
WRITE_MEM  258, 687
SHR        867, 590, 115
```
# Использование

**Запуск ассемблера**

 ```asm
python assembler.py source.asm output.bin
```
## Этап 3. Интерпретатор и операции с памятью

### Цель этапа

Реализовать интерпретатор учебной вычислительной машины (УВМ), включающий:
- цикл интерпретации команд,
- модель памяти УВМ,
- выполнение базовых команд работы с памятью,
- формирование дампа памяти после выполнения программы.

---

### Функциональные требования

Интерпретатор должен:

1. Принимать аргументы командной строки:
   - путь к бинарному файлу с ассемблированной программой;
   - путь к файлу, в который сохраняется дамп памяти;
   - диапазон адресов памяти для вывода дампа.

2. Использовать формат **CSV** для сохранения дампа памяти.

3. Реализовать модель памяти УВМ:
   - память команд и память данных логически объединены;
   - в реализации используется раздельное хранение команд и данных
     для корректного исполнения программы.

4. Реализовать основной цикл интерпретации:
   - последовательное чтение команд из бинарного файла;
   - декодирование команды в промежуточное представление;
   - выполнение команды;
   - переход к следующей инструкции.

5. Поддерживать выполнение следующих команд:
   - `LOAD_CONST` — загрузка константы в память;
   - `READ_MEM` — чтение значения из памяти;
   - `WRITE_MEM` — запись значения в память.

---

### Модель памяти

- Память представлена массивом фиксированного размера (4096 ячеек).
- Каждая ячейка памяти содержит целое число.
- Адреса памяти являются индексами массива.
- Память команд хранится отдельно в виде массива байтовых инструкций,
  что не нарушает логическую модель единой памяти УВМ.

---

### Запуск интерпретатора

```bash
python interpreter.py program.bin dump.csv 100:200
python assembler.py copy_test.asm copy_test.bin 
```

## Этап 4. Реализация арифметико-логического устройства (АЛУ)

### Цель этапа

Завершить реализацию интерпретатора УВМ, добавив поддержку
вычислительных операций, реализуемых арифметико-логическим устройством.

---

### Реализованная операция

#### Побитовый арифметический сдвиг вправо
SHR B, C, D
**Семантика:**
memory[C] ← memory[D] >> memory[B]

- выполняется арифметический (знаковый) сдвиг вправо;
- используется встроенный оператор Python `>>`.

---

### Реализация в интерпретаторе

Команда `SHR` реализована в основном цикле интерпретации и выполняется
над значениями, хранящимися в памяти УВМ.  
Результат операции сохраняется в память по адресу `C`.

---

### Тестирование

Для проверки корректности реализации написана тестовая программа,
выполняющая арифметический сдвиг вправо с сохранением результата в память.

#### Пример тестовой программы

```asm
LOAD_CONST 10, 64
LOAD_CONST 11, 2
SHR 11, 12, 10
```
### Запуск интерпретатора
```asm
python assembler.py shr_test.asm shr_test.bin 
python interpreter.py shr_test.bin dump.csv 10:15
```
## Этап 5. Выполнение тестовой задачи

### Цель этапа

Использовать разработанные ассемблер и интерпретатор УВМ
для решения тестовой вычислительной задачи.

---

### Условие задачи

Выполнить поэлементно команду побитовый арифметический сдвиг вправо
над двумя векторами длины 8.



Результат вычислений должен быть записан в первый вектор.

---

### Реализация решения

- Векторы размещаются в памяти УВМ.
- Вычисления выполняются командой `SHR`.
- Циклы отсутствуют, операции развёрнуты вручную.
- Результат сохраняется непосредственно в вектор `A`.

---

### Примеры программ

Реализованы три программы с различными исходными данными:
1. Базовый пример со сдвигом на 1.
2. Пример с различными величинами сдвига.
3. Пример со смешанными значениями данных.

Для каждой программы:
- выполнено ассемблирование;
- выполнена интерпретация;
- проверен дамп памяти.

---

### Результат этапа

- Тестовая задача полностью решена.
- Корректность вычислений подтверждена дампами памяти.
- Ассемблер и интерпретатор успешно применены для решения прикладной задачи.

### Запуск интерпретатора

В примере представлен только один вектор, но таких векторов 3!
```asm
 python assembler.py vector_shr_1.asm v1.bin
 python interpreter.py v1.bin dump1.csv 95:120
```

## Этап 6. Написание GUI для различных платформ

Этап 6 посвящён созданию кроссплатформенной версии УВМ (Учебной виртуальной машины) с графическим интерфейсом и поддержкой следующих платформ:

Windows

Linux

Web / WASM (браузер)

Основные функции GUI:

Редактируемое окно программы на языке ассемблера

Кнопка «Ассемблировать и запустить»

Окно вывода дампа памяти

Для запуска интерпретатора на Linux/Windows:

```asm
python gui_main.py
```

Для запуска интерпретатора в Web/WASM:
```asm
python3 -m http.server
http://localhost:8000
```

Для запуска скрипта:
```asm
 python build.py desktop/web
```
После создания папки dist откройте файл gui_main, если используете Linux/Windows

Для версии web/wasm следуйте шагам в консоли